<!DOCTYPE html>
<html lang="en">
    <head>
        <title>People Fetch Async</title>
        <link rel="stylesheet" href="people.css" />
    </head>
    <body>
        <table id="peopleTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Full Name</th>
                    <th>E-mail</th>
                    <th>Gender</th>
                    <th>IP Address</th>
                </tr>
            </thead>
            <tbody id="people"></tbody>
        </table>
        <script>
        function stringToNode(html) {
            const template = document.createElement("template");
            html = html.trim();
            template.innerHTML = html;
            return template.content.firstChild;
        }

        function createPerson(person) {
            const content = 
                `<tr>
                    <td>${person.id}</td>
                    <td>${person.first_name} ${person.last_name}</td>
                    <td>${person.email}</td>
                    <td>${person.gender}</td>
                    <td>${person.ip_address}</td>
                </tr>`;
                return stringToNode(content);
        }

        function parsePerson(xml) {
            const first_name = xml.getElementsByTagName("first_name")[0].childNodes[0].nodeValue;
            const last_name = xml.getElementsByTagName("last_name")[0].childNodes[0].nodeValue;
            const email = xml.getElementsByTagName("email")[0].childNodes[0].nodeValue;
            const gender = xml.getElementsByTagName("gender")[0].childNodes[0].nodeValue;
            const ip_address = xml.getElementsByTagName("ip_address")[0].childNodes[0].nodeValue;
            const id = xml.getElementsByTagName("id")[0].childNodes[0].nodeValue;

            return {first_name, last_name, email, gender, ip_address, id};
        }

        function displayData(xmlDoc) {
            const people = xmlDoc.getElementsByTagName("person");
            const list = document.getElementById("people");

            for (let index = 0; index < people.length; index++) {
                const element = people[index];
                const parsedPerson = parsePerson(element);
                const personElement = createPerson(parsedPerson);
                list.appendChild(personElement);
            }
            console.log(xmlDoc)
        }

        const main = async () => {
            const response = await fetch("people.xml");
            const str = await response.text();
            const xmlData = new DOMParser().parseFromString(str, "text/xml");
            displayData(xmlData);
        };

        main();




        </script>
    </body>
</html>