<!DOCTYPE html>
<html>
    <head>
        <title>People</title>
        <style>
            #container>div{
                border: 2px solid black;
                border-radius: 10px;
                display: inline-block;
                margin: 10px;
                padding: 10px;
                width:20%;
            }
        </style>
    </head>
    <body>
        <div id="container"></div>

        <script>
            const xhr = (url, method = "GET") => {
                return new Promise(resolve => {
                    const xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function(){
                        if(this.readyState == 4 & this.status == 200){
                            resolve(this);
                            
                            
                        }
                    }
                    xhttp.open(method, url);
                    xhttp.send();
                })
            }


            const displayData = (xmlDoc) => {
                const people = xmlDoc.getElementsByTagName("person");

                for(let person of people){
                    const templateString = 
                        `<div>
                            <h2>
                                ${person.getElementsByTagName("fname")[0].childNodes[0].nodeValue} 
                                ${person.getElementsByTagName("lname")[0].childNodes[0].nodeValue}   
                            </h2>
                            <p>
                                Gender: ${person.getElementsByTagName("gender")[0].childNodes[0].nodeValue},
                                ID: ${person.getElementsByTagName("id")[0].childNodes[0].nodeValue}
                            </p>
                            <p>
                                ${person.getElementsByTagName("email")[0].childNodes[0].nodeValue}
                            </p>
                            <p>
                                ${person.getElementsByTagName("ipAddress")[0].childNodes[0].nodeValue}
                            </p>
                        </div>`;

                    const template = document.createElement("template");
                    template.innerHTML = templateString;
                    document.getElementById("container").append(template.content.firstChild);
                }
            }

            
            // xhr("people.xml").then((data) => displayData(data.responseXML));

            // fetch("people.xml").then(result => result.text()).then(data => {
            //     const parser = new DOMParser();
            //     const xmlDoc = parser.parseFromString(data, "text/xml");
            //     displayData(xmlDoc);
            // })

            (async()=> {
                const result = await fetch("people.xml");
                const text = await result.text();
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(text, "text/xml");
                displayData(xmlDoc);
            })();
        </script>
    </body>
</html>