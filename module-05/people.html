<!DOCTYPE html>
<html>
    <head>
        <title>People</title>
    </head>
    <body>
        <ol id="cards"></ol>
        <script>
            const xhttp=new XMLHttpRequest();
            xhttp.onreadystatechange=function(){
                if(this.readyState==4&&this.status==200){
                    console.log(this.responseXML);
                    displayData(this.responseXML);
                }
            };
            xhttp.open("GET","people.xml",true)
            xhttp.send();

            function stringToNode(html) {
                const template = document.createElement(`template`);
                html = html.trim();
                template.innerHTML = html;
                return template.content.firstChild;
      }

            function createCard(card){
                const content=`<li>
                    <p>${card.id}</p>
                    <h2>${card.firstname + " "+card.lastname}</h2>
                   
                    <p>${card.email}</p>
                    <p>${card.gender}</p>
                    <p>${card.ipaddress}</p>
                    </li>`;
                    return stringToNode(content);                
            }

            function displayData(xmlDoc){
                const cards = xmlDoc.getElementsByTagName(`details`);
                const list = document.getElementById(`cards`);

                for(let index=0;index < cards.length; index++){
                    const element = cards[index];
                    const parsedCard = parseCard(element);

                    const cardElement = createCard(parsedCard);
                    list.appendChild(cardElement);
                }
            }
            function parseCard(xml){
                const id = xml.getElementsByTagName(`id`)[0].childNodes[0].nodeValue;
                const firstname = xml.getElementsByTagName(`first_name`)[0].childNodes[0].nodeValue;
                const lastname = xml.getElementsByTagName(`last_name`)[0].childNodes[0].nodeValue;
                const email = xml.getElementsByTagName(`email`)[0].childNodes[0].nodeValue;
                const gender = xml.getElementsByTagName(`gender`)[0].childNodes[0].nodeValue;
                const ipaddress = xml.getElementsByTagName(`ip_address`)[0].childNodes[0].nodeValue;

                return{
                    id,
                    firstname,
                    lastname,
                    email,
                    gender,
                    ipaddress,
                };
            }
        </script>
    </body>
</html>