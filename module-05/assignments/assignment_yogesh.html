<!DOCTYPE html>
<html lang="en">
  <head>
    <title>customers</title>
  </head>
  <body>
    <ol id="customersList"></ol>
    <script>
      var orderID ="";
        var orderDate ="";
        var itemPrice = "";
         var itemQty= "";
      const xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
          displayData(this.responseXML);
        }
      };
      xhttp.open("GET", "..//customers.xml", true);
      xhttp.send();

      function stringToNode(html) {
        const template = document.createElement(`template`);
        html = html.trim();
        template.innerHTML = html;
        return template.content.firstChild;
      }
      function parseInfo(xml) {
       
        const id =
          xml.getAttribute("custID");
          const name =
          xml.getElementsByTagName(`name`)[0].childNodes[0].nodeValue;
          const title =
          xml.getElementsByTagName("name")[0].getAttribute("title");
          const address =
          xml.getElementsByTagName(`address`)[0].childNodes[0].nodeValue;
          const phone =
          xml.getElementsByTagName(`phone`)[0].childNodes[0].nodeValue;
          const email =
          xml.getElementsByTagName(`email`);

          try{
           var emailText=email[0].childNodes[0].nodeValue;
          }
          catch (error){
            var emailText = "No email address"
          }

          const orderItems = xml.getElementsByTagName(`order`);
          for (let j = 0; j < orderItems.length; j++) 
          {
            orderID =orderItems[j].getAttribute("orderID");
            orderBy =orderItems[j].getAttribute("orderBy");
            orderDate = orderItems[j].getElementsByTagName(`orderDate`)[0].childNodes[0].nodeValue;
            const itemLists = orderItems[j].getElementsByTagName(`item`);
            for (let k = 0; k < itemLists.length; k++)
            {
              itemPrice = itemLists[k].getElementsByTagName(`itemPrice`)[0].childNodes[0].nodeValue;
              itemQty = itemLists[k].getElementsByTagName(`itemQty`)[0].childNodes[0].nodeValue;
              
            }
          }

        return {
            id,
            title,
            name,
            address,
            phone,
            emailText,orderID,
            orderBy,
            orderDate,
            itemPrice,
            itemQty,
        };
      }

      function createCustomerInfo(customer) {
        const content = `<li>
  <article>
    <div>${customer.id}</div>
    <h2>${customer.title} ${customer.name}</h2>
    <div>${customer.address}</div>
    <div>${customer.phone}</div>
    <div>${customer.emailText}</div>
    <h4>OrderID: ${customer.orderID}</h4>
    <h4>OrderBy: ${customer.orderBy}</h4>
    <h4>OrderDate: ${customer.orderDate}</h4>
    <div>Item price: ${customer.itemPrice}</div>
    <div>Item quamtity: ${customer.itemQty}</div>
    <br>
  </article>
</li>`;

return stringToNode(content);
}

      function displayData(xmlDoc) {
        const customers = xmlDoc.getElementsByTagName(`customer`);
        const list = document.getElementById(`customersList`);
        for (let index1 = 0; index1 < customers.length; index1++) {
          const element = customers[index1];
          const parsedCustomer = parseInfo(element);
          const customerElement = createCustomerInfo(parsedCustomer);
          list.appendChild(customerElement);
        }
      }     

    </script>
  </body>
</html>
