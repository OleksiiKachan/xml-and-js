<!DOCTYPE html>
 <html lang="en">
   <head>
     <meta charset="UTF-8" />
     <link rel="stylesheet" href="Assignment.css" />
     <title>Module-5 Assignment Sibi</title>
   </head>
   
   <body>
     <!-- Display Data in the Table format -->
     <table id="customer_detail" border="2">
       <tr>
         <th>Customer ID</th>
         <th>Full Name</th>
         <th>Address</th>
         <th>Phone</th>
         <th>Email</th>
         <th>Order</th>
         <th>Items</th>
     </tr>
     </table>
     <script>

         // Function for HTTTP Request
       const xhttp = new XMLHttpRequest();
       xhttp.onreadystatechange = function () {
         if (this.readyState == 4 && this.status == 200) {
           displayData(this.responseXML);
         }
       };
       //GET method and send request to XML
       xhttp.open("GET", "../customers.xml", true);
       xhttp.send();


        stringToNode = (content)=> 
        {
         const template = document.createElement(`template`);
         content = content.trim();
         template.innerHTML = content;
         return template.content.firstChild;
        }

        CreateCustomerInformation=(customer) =>
       {
         const content = `
         <tr>
         <td>${customer.id}</td>
         <td>${customer.title} ${customer.name}</td>
         <td>${customer.address}</td>
         <td>${customer.phone}</td>
         <td>${customer.email}</td>
         <td>
           <table>
             <tr>
               <td>OrderID: ${customer.orderID}</td>
             </tr>
             <tr>
               <td>OrderBy: ${customer.orderBy}</td>
             </tr>
             <tr>
               <td>OrderDate: ${customer.orderDate}</td>
             </tr>
           </table>
         </td>
         <td>
           <table>
             <tr>
               <td>Item price: ${customer.itemPrice}</td>
            </tr>
            <tr>
               <td>Item quantity: ${customer.itemQty}</td>
             </tr>
           </table>
         </td>
       </tr>
         `;

         return stringToNode(content);
       }

        parseInfo=(element)=>{
         const id = element.attributes[0].nodeValue;
         const title =
           element.getElementsByTagName("name")[0].attributes[0].nodeValue;
         const name =
           element.getElementsByTagName(`name`)[0].childNodes[0].nodeValue;
         const address =
           element.getElementsByTagName(`address`)[0].childNodes[0].nodeValue;
         const phone =
           element.getElementsByTagName(`phone`)[0].childNodes[0].nodeValue;

         if (!element.getElementsByTagName(`email`)[0]) {
           var email = "No email Provided.";
         } else {
           var email =
             element.getElementsByTagName(`email`)[0].childNodes[0].nodeValue;
         }

         const orderID =
           element.getElementsByTagName(`order`)[0].attributes[0].nodeValue;
         const orderBy =
           element.getElementsByTagName(`order`)[0].attributes[1].nodeValue;
         const orderDate =
           element.getElementsByTagName(`orderDate`)[0].childNodes[0].nodeValue;
         const itemPrice =
           element.getElementsByTagName(`itemPrice`)[0].childNodes[0].nodeValue;
         const itemQty =
           element.getElementsByTagName(`itemQty`)[0].childNodes[0].nodeValue;

         return {
           id,
           title,
           name,
           address,
           phone,
           email,
           orderID,
           orderBy,
           orderDate,
           itemPrice,
           itemQty,
         };
       }

       function displayData(xmlDoc) {
         const customer_data = xmlDoc.getElementsByTagName(`customer`);
         const list = document.getElementById(`customer_detail`);

         for (let i = 0; i < customer_data.length; i++) {
           const customer_element = customer_data[i];
           const customer_parsed = parseInfo(customer_element);

           const customer_element_info = CreateCustomerInformation(customer_parsed);
           list.appendChild(customer_element_info);
         }
       }
     </script>
   </body>
 </html>