<html>
    <head>
        <title>people.html</title>
    </head>
    <body>
        <ol id="people"></ol>
        <script>
            const xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function(){
                if (this.readyState === 4 && this.status === 200){
                    displayData(this.responseXML);
                }
            };
            xhttp.open("GET", "people.xml", true);
            xhttp.send();

            function stringToNode(html){
                const template = document.createElement(`template`);
                html = html.trim();
                template.innerHTML = html;
                return template.content.firstChild;
            }
            
            function createPeople(people){
                const content = `<li>
                    <article>
                    <h2>${people.first_name} ${people.last_name}</h2>
                    <h3>${people.id}</h3>
                    <p>${people.email}</p>
                    <p>${people.gender}</p>
                    <p>${people.ip_address}</p>
                    </article>
                    </li>`
                return stringToNode(content);
            }

            function parsePeople(xml){
                const first_name = xml.getElementsByTagName(`first_name`)[0].childNodes[0].nodeValue;
                const last_name = xml.getElementsByTagName(`last_name`)[0].childNodes[0].nodeValue;
                const id = xml.getElementsByTagName(`id`)[0].childNodes[0].nodeValue;
                const email = xml.getElementsByTagName(`email`)[0].childNodes[0].nodeValue;
                const gender = xml.getElementsByTagName(`gender`)[0].childNodes[0].nodeValue;
                const ip_address = xml.getElementsByTagName(`ip_address`)[0].childNodes[0].nodeValue;
                return {
                    first_name,
                    last_name,
                    id,
                    email,
                    gender,
                    ip_address
                };
            }

            function displayData(xmlDoc){
                const people = xmlDoc.getElementsByTagName(`person`);
                const list = document.getElementById(`people`);

                for (let index = 0; index < people.length; index ++){
                    const element = people[index];
                    const parsedPeople = parsePeople(element);

                    const peopleElement = createPeople(parsedPeople);
                    list.appendChild(peopleElement);
                }
            }

        </script>
    </body>

</html>